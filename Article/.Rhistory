library(foreign)
Data <- read.dta("p53_tma_long.dta")
View(Data)
unique(Data$caseid)
length(unique(Data$caseid))
nrow(Data)
licence()
citation()
wilcox.test(Data$p53, Data$ijp53)
?scale
wilcox.test(scale(Data$p53), scale(Data$ijp53))
scale(Data$p53)
plot(scale(Data$p53))
hist(scale(Data$p53))
plot(scale(Data$p53))
(Data$p53 - mean(Data$p53))/nrow(Data)
(Data$p53 - mean(Data$p53, na.rm = TRUE))/nrow(Data)
hist((Data$p53 - mean(Data$p53, na.rm = TRUE))/nrow(Data))
hist(log((Data$p53 - mean(Data$p53, na.rm = TRUE))/nrow(Data)))
hist(log((Data$p53 - mean(Data$p53, na.rm = TRUE))/nrow(Data) + 1))
p53.z <- (Data$p53 - mean(Data$p53, na.rm = TRUE))/nrow(Data)
p53ij.z <- (Data$ijp53 - mean(Data$ijp53, na.rm = TRUE))/nrow(Data)
wilcox.test(p53.z, p53ij.z)
cor.test(Data$p53, Data$ijp53)
?cor.test
cor.test(Data$p53, Data$ijp53)p.valu
cor.test(Data$p53, Data$ijp53)p.value
cor.test(Data$p53, Data$ijp53)$p.value
cor.test(Data$p53, Data$ijp53)$estimate
cor.test(Data$p53, Data$ijp53, method = "Spearman")$estimate
cor.test(Data$p53, Data$ijp53, method = "spearman")$estimate
cor.test(Data$p53, Data$ijp53, method = "spearman")$p.value
View(Data)
library(cowplot)
install.packages("cowplot")
library(cowplot)
?"cowplot"
theme_cowplot(font_size = 14, font_family = "", line_size = 0.5)
plot1 <- ggplot(Data_Long, aes(method, value, fill = method)) +
geom_boxplot() +
guides(fill = FALSE) +
scale_x_discrete(labels = c("Visual Estimation", "Digital Estimation")) +
ylab("Positive Cells, %") + xlab("")
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
?save_plot
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
save_plot("Fig2.png", fig2, base_aspect_ratio = 2.5)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
geom_smooth(method = lm) +
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
table(Data$subtype)
Data %>% group_by(subtype) %>% mean(p53)
Data %>% group_by(subtype) %>% mean(p53, na.rm = TRUE)
View(Data)
glimpse(Data)
Data %>% group_by(subtype) %>% summarize(mean(p53, na.rm = TRUE))
Data %>% group_by(subtype) %>% summarize(Mean = mean(p53, na.rm = TRUE))
summarize(Mean = mean(p53, na.rm = TRUE), SD = sd(p53, na.rm = TRUE))
Data %>%
group_by(subtype) %>%
summarize(Mean = mean(p53, na.rm = TRUE), SD = sd(p53, na.rm = TRUE))
Data %>% tbl(Data %>%)
group_by(subtype) %>%
summarize(Mean = mean(p53, na.rm = TRUE), SD = sd(p53, na.rm = TRUE))
Data %>% tbl(Data) %>%
group_by(subtype) %>%
summarize(Mean = mean(p53, na.rm = TRUE), SD = sd(p53, na.rm = TRUE))
table(Data$subtype)
Data %>%
group_by(subtype) %>%
summarize(N = count(), Mean = mean(p53, na.rm = TRUE), SD = sd(p53, na.rm = TRUE))
Data %>%
group_by(subtype) %>%
summarize(N = n(), Mean = mean(p53, na.rm = TRUE), SD = sd(p53, na.rm = TRUE))
Data %>%
group_by(subtype) %>%
summarize(
N = n(),
Mean = mean(p53, na.rm = TRUE),
SD = sd(p53, na.rm = TRUE)
) %>%
arrange(N)
Data %>%
group_by(subtype) %>%
summarize(
N = n(),
Mean = mean(p53, na.rm = TRUE),
SD = sd(p53, na.rm = TRUE)
) %>%
arrange(desc(N))
Data %>%
group_by(subtype) %>%
summarize(
N = n(),
Mean = signif(mean(p53, na.rm = TRUE), 1),
SD = sd(p53, na.rm = TRUE)
) %>%
arrange(desc(N))
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
View(Data)
View(Data_Long)
View(Data)
Data %>%
select(caseid, subtype, grade)
?gather
?tidyr
Data %>%
select(caseid, subtype, grade) %>%
group_by(caseid) %>%
mutate(ID = caseid)
Data %>%
select(caseid, subtype, grade) %>%
group_by(caseid) %>%
summarize(ID = caseid)
Data %>%
select(caseid, subtype, grade) %>%
group_by(caseid) %>%
summarize(ID == caseid)
Data %>%
select(caseid, subtype, grade) %>%
unique(caseid)
Data %>%
select(caseid, subtype, grade) %>%
unique()
Data %>%
select(caseid, subtype, grade) %>%
unique %>%
mutate(ID = row_number)
Data %>%
select(caseid, subtype, grade) %>%
unique() %>%
mutate(ID = row_number)
Data %>%
select(caseid, subtype, grade) %>%
unique() %>%
mutate(ID = row_number())
Data %>%
select(caseid, subtype, grade) %>%
unique(caseid) %>%
mutate(ID = row_number())
library(plyr)
ddply(Data, c(caseid, subtype), grade = max(grade))
View(Data)
ddply(Data, .(caseid, subtype), grade = max(grade))
ddply(Data, .(caseid, subtype), summarize, grade = max(grade))
ddply(Data, .(caseid, subtype), summarize, grade = max(grade, na.rm = TRUE))
Data %>% select(caseid, subtype, grade)
Data %>% select(caseid, subtype, grade) %>% group_by(case_id, subtype) %>% sumarize(max(grade))
Data %>% select(caseid, subtype, grade) %>% group_by(caseid, subtype) %>% sumarize(max(grade))
Data %>% select(caseid, subtype, grade) %>% group_by(caseid, subtype) %>% summarize(max(grade))
Data %>% select(caseid, subtype, grade) %>% group_by(caseid, subtype)
Data %>% select(caseid, subtype, grade) %>% group_by(caseid, subtype) %>% mutate(max(grade))
?unique
Data %>% select(caseid, subtype, grade) %>% group_by(caseid, subtype) %>% mutate(caseid = unique(caseid), max(grade))
Data %>% select(caseid, subtype, grade) %>% group_by(caseid, subtype) %>% mutate(caseid = unique(caseid), subtype = unique(subtype), max(grade))
Data %>% select(caseid, subtype, grade) %>% mutate(caseid = unique(caseid), subtype = unique(subtype), max(grade))
Data %>% select(caseid, subtype, grade) %>% summarize(caseid = unique(caseid), subtype = unique(subtype), max(grade))
Data %>% select(caseid, subtype, grade) %>% summarize(max(grade))
Data %>% select(caseid, subtype, grade) %>% group_by(caseid) %>% summarize(max(grade))
Data_Wide <- ddply(Data, .(caseid, subtype), summarize, grade = max(grade, na.rm = TRUE))
View(Data_Wide)
Data_Wide
Data_Wide$subtype
Data_Wide %>%
group_by(subtype) %>%
summarize(N = n())
Data %>%
group_by(subtype) %>%
summarize(
Mean = round(mean(p53, na.rm = TRUE), 1),
SD = round(sd(p53, na.rm = TRUE), 1)
) %>%
arrange(de
Data %>%
group_by(subtype) %>%
summarize(
Mean = round(mean(p53, na.rm = TRUE), 1),
SD = round(sd(p53, na.rm = TRUE), 1)
) %>%
arrange(desc(N))
Data %>%
group_by(subtype) %>%
summarize(
N = n(),
Mean = round(mean(p53, na.rm = TRUE), 1),
SD = round(sd(p53, na.rm = TRUE), 1)
) %>%
arrange(desc(N))
?summarize
Data %>%
group_by(subtype) %>%
summarize(
N = dplyr::n(),
Mean = round(mean(p53, na.rm = TRUE), 1),
SD = round(sd(p53, na.rm = TRUE), 1)
) %>%
arrange(desc(N))
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
Data_Wide %>%
group_by(subtype) %>%
summarize(N = n())
Data %>%
group_by(subtype) %>%
summarize(
N = n(),
Mean = round(mean(p53, na.rm = TRUE), 1),
SD = round(sd(p53, na.rm = TRUE), 1)
) %>%
arrange(desc(N))
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
Data_Wide %>%
group_by(subtype) %>%
summarize(N = n())
Data_Wide %>%
group_by(subtype) %>%
summarize(N = n()) %>%
arrange(N)
Data_Wide %>%
group_by(subtype) %>%
summarize(N = n()) %>%
arrange(desc(N))
Data_Wide %>%
group_by(subtype, grade) %>%
summarize(N = n()) %>%
arrange(desc(N))
T1_subt <- Data_Wide %>%
group_by(subtype) %>%
summarize(N = n()) %>%
arrange(desc(N))
View(T1_subt)
Data_Wide %>%
group_by(subtype) %>%
summarize(N = n(), Perc = N/nrow(Data_wide)) %>%
arrange(desc(N))
Data_Wide %>%
group_by(subtype) %>%
summarize(N = n(), Perc = N/nrow(Data_Wide)) %>%
arrange(desc(N))
Data_Wide %>%
group_by(grade) %>%
summarize(N = n()) %>%
Data_Wide %>%
group_by(grade) %>%
summarize(N = n())
Data_Wide %>%
group_by(grade) %>%
summarize(N = n())
T1_subt["usual",]
T1_subt["usual"]
T1_subt["usual", "N"]
T1_subt
T1_subt[1,]
T1_subt[usual,]
T1_subt["usual",]
T1_subt[1,2]
Data %>%
group_by(subtype) %>%
summarize(
N = n(),
Mean = round(mean(p53, na.rm = TRUE), 1),
SD = round(sd(p53, na.rm = TRUE), 1)
) %>%
arrange(desc(N))
Data %>%
group_by(subtype) %>%
summarize(
Mean = round(mean(p53, na.rm = TRUE), 1),
SD = round(sd(p53, na.rm = TRUE), 1)
)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
View(T1_v)
View(Data)
Data %>%
group_by(subtype) %>%
summarize(
N = n(),
Mean = round(mean(ijp53, na.rm = TRUE), 1),
SD = round(sd(ijp53, na.rm = TRUE), 1)
) %>%
arrange(desc(N))
Data %>%
group_by(subtype) %>%
summarize(
N = n(),
Mean_V = round(mean(p53, na.rm = TRUE), 1),
SD_V = round(sd(p53, na.rm = TRUE), 1),
Mean_D = round(mean(ijp53, na.rm = TRUE), 1),
SD_D = round(sd(ijp53, na.rm = TRUE), 1)
) %>%
arrange(desc(N))
Data %>%
group_by(grade) %>%
summarize(
N = n(),
Mean_V = round(mean(p53, na.rm = TRUE), 1),
SD_V = round(sd(p53, na.rm = TRUE), 1),
Mean_D = round(mean(ijp53, na.rm = TRUE), 1),
SD_D = round(sd(ijp53, na.rm = TRUE), 1)
) %>%
arrange(desc(N))
Data %>%
group_by(grade) %>%
filter(!is.na(grade)) %>%
summarize(
N = n(),
Mean_V = round(mean(p53, na.rm = TRUE), 1),
SD_V = round(sd(p53, na.rm = TRUE), 1),
Mean_D = round(mean(ijp53, na.rm = TRUE), 1),
SD_D = round(sd(ijp53, na.rm = TRUE), 1)
) %>%
arrange(desc(N))
Data %>%
group_by(grade) %>%
filter(!is.na(grade)) %>%
summarize(
N = n(),
Mean_V = round(mean(p53, na.rm = TRUE), 1),
SD_V = round(sd(p53, na.rm = TRUE), 1),
Mean_D = round(mean(ijp53, na.rm = TRUE), 1),
SD_D = round(sd(ijp53, na.rm = TRUE), 1)
)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
View(T1_p53_s)
View(T1_p53_hg)
?transform
?dplyr::transmute
Data %>%
mutate(p53 = (p53 - mean(p53, na.rm = TRUE)/sd(p53, na.rm = TRUE)))
Data %>%
mutate(p53 = (p53 - mean(p53, na.rm = TRUE)/sd(p53, na.rm = TRUE))) %>%
hist(p53)
Data %>%
mutate(p53 = (p53 - mean(p53, na.rm = TRUE)/sd(p53, na.rm = TRUE))) %>%
plot(p53)
Data %>%
transmute(p53 = (p53 - mean(p53, na.rm = TRUE)/sd(p53, na.rm = TRUE))) %>%
Data %>%
transmute(p53 = (p53 - mean(p53, na.rm = TRUE)/sd(p53, na.rm = TRUE)))
Data %>%
mutate(
p53 = (p53 - mean(p53, na.rm = TRUE)/sd(p53, na.rm = TRUE)),
ijp53 = (ijp53 - mean(ijp53, na.rm = TRUE)/sd(ijp53, na.rm = TRUE))
)
View(Data)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
boxplot(p53, ijp53, Data)
?boxplot
boxplot(Data$p53, Data$ijp53)
boxplot(Data$p53_z, Data$ijp53_z)
source('~/achaux@gmail.com/Data Science/My Papers - Ongoing/My Penile Dataset/chaux_p53_tma/Article/p53_Penile.R', echo=TRUE)
plot(Data$p53_z)
plot(Data$p53_z, Data$ijp53_z)
lm(Data$p53_z, Data$ijp53_z)
lm(Data$p53_z ~ Data$ijp53_z)
line(lm(Data$p53_z ~ Data$ijp53_z))
abline(lm(Data$p53_z ~ Data$ijp53_z))
plot(Data$p53_z, Data$ijp53_z)
abline(lm(Data$p53_z ~ Data$ijp53_z))
T1_p53_s
View(Data)
kruskal.test(p53 ~ subtype, Data)
boxplot(p53 ~ subtype, Data)
kruskal.test(ijp53 ~ subtype, Data)
boxplot(ijp53 ~ subtype, Data)
kruskal.test(p53 ~ grade, Data)
boxplot(p53 ~ grade, Data)
kruskal.test(ijp53 ~ grade, Data)
boxplot(ijp53 ~ grade, Data)
kruskal.test(p53_z ~ subtype, Data)
boxplot(p53_z ~ subtype, Data)
kruskal.test(p53_z ~ grade, Data)
boxplot(p53_z ~ grade, Data)
kruskal.test(p53_z ~ subtype, Data)
kruskal.test(p53_z ~ subtype, Data)$p.value
format(kruskal.test(p53_z ~ subtype, Data)$p.value, digits = 2)
KW_p53_s_D <- format(kruskal.test(p53 ~ subtype, Data)$p.value, digits = 2)
KW_p53_s_D
KW_ijp53_s <- format(kruskal.test(ijp53 ~ subtype, Data)$p.value, digits = 2)
KW_ijp53_s
KW_p53_hg <- format(kruskal.test(p53 ~ grade, Data)$p.value, digits = 2)
KW_ijp53_hg <- format(kruskal.test(ijp53 ~ grade, Data)$p.value, digits = 2)
KW_p53_hg
KW_ijp53_hg
